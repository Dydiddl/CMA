# 현장 관리 시스템

## 시스템 개요
이 문서는 건설 현장의 관리 구조와 기능을 정의합니다.
현장 정보 관리, 인력 관리, 자재 관리, 일정 관리 등을 관리합니다.

## 주요 기능

### 1. 현장 정보 관리
현장의 기본 정보를 관리합니다.
- 현장 등록: 새로운 현장 등록
- 정보 수정: 현장 정보 변경
- 정보 조회: 현장 정보 조회
- 이력 관리: 정보 변경 이력 관리

### 2. 인력 관리
현장 인력을 관리합니다.
- 인력 배치: 현장 인력 배치
- 인력 이동: 인력 배치 변경
- 인력 조회: 현장 인력 조회
- 인력 통계: 인력 현황 통계

### 3. 자재 관리
현장 자재를 관리합니다.
- 자재 등록: 자재 정보 등록
- 자재 수정: 자재 정보 변경
- 자재 조회: 자재 목록 조회
- 재고 관리: 자재 재고 관리

### 4. 일정 관리
현장 일정을 관리합니다.
- 일정 등록: 작업 일정 등록
- 일정 수정: 일정 정보 변경
- 일정 조회: 일정 목록 조회
- 진행 관리: 일정 진행 관리

## DB 연계
```sql
-- 현장 테이블: 현장의 기본 정보를 저장합니다.
-- 예: 현장명, 주소, 공사 기간, 현장 책임자 등의 정보를 관리합니다.
CREATE TABLE construction_sites (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 현장의 고유 식별자
    name VARCHAR(100) NOT NULL,                      -- 현장명
    code VARCHAR(50) UNIQUE NOT NULL,                -- 현장 코드
    address TEXT NOT NULL,                           -- 주소
    start_date DATE NOT NULL,                        -- 착공일
    end_date DATE,                                   -- 준공일
    manager_id UUID REFERENCES users(id),            -- 현장 책임자 ID
    status VARCHAR(50) NOT NULL,                     -- 현장 상태
    description TEXT,                                -- 설명
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 현장 상세 정보 테이블: 현장의 추가 정보를 저장합니다.
-- 예: 공사 규모, 공사 유형, 주요 공정 등을 관리합니다.
CREATE TABLE site_details (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 상세 정보의 고유 식별자
    site_id UUID REFERENCES construction_sites(id),  -- 현장 ID
    construction_type VARCHAR(100),                  -- 공사 유형
    total_area DECIMAL(10,2),                        -- 연면적
    total_cost DECIMAL(15,2),                        -- 총 공사비
    main_process TEXT,                               -- 주요 공정
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 현장 인력 테이블: 현장 인력 정보를 저장합니다.
-- 예: 인력 배치, 직종, 작업 내용 등을 관리합니다.
CREATE TABLE site_personnel (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 인력의 고유 식별자
    site_id UUID REFERENCES construction_sites(id),  -- 현장 ID
    user_id UUID REFERENCES users(id),               -- 사용자 ID
    position VARCHAR(100),                           -- 직위
    work_type VARCHAR(100),                          -- 작업 유형
    start_date DATE NOT NULL,                        -- 배치 시작일
    end_date DATE,                                   -- 배치 종료일
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 현장 자재 테이블: 현장 자재 정보를 저장합니다.
-- 예: 자재명, 수량, 단위, 공급업체 등을 관리합니다.
CREATE TABLE site_materials (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 자재의 고유 식별자
    site_id UUID REFERENCES construction_sites(id),  -- 현장 ID
    name VARCHAR(100) NOT NULL,                      -- 자재명
    quantity DECIMAL(10,2) NOT NULL,                 -- 수량
    unit VARCHAR(20) NOT NULL,                       -- 단위
    supplier_id UUID REFERENCES vendors(id),         -- 공급업체 ID
    status VARCHAR(50),                              -- 상태
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 현장 일정 테이블: 현장 일정 정보를 저장합니다.
-- 예: 공정명, 시작일, 종료일, 담당자 등을 관리합니다.
CREATE TABLE site_schedules (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 일정의 고유 식별자
    site_id UUID REFERENCES construction_sites(id),  -- 현장 ID
    name VARCHAR(100) NOT NULL,                      -- 공정명
    start_date DATE NOT NULL,                        -- 시작일
    end_date DATE NOT NULL,                          -- 종료일
    manager_id UUID REFERENCES users(id),            -- 담당자 ID
    status VARCHAR(50),                              -- 상태
    progress INTEGER DEFAULT 0,                      -- 진행률
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 현장 이력 테이블: 현장 정보 변경 사항을 추적합니다.
-- 예: 현장명 변경, 책임자 변경, 상태 변경 등의 이력을 관리합니다.
CREATE TABLE site_history (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 이력의 고유 식별자
    site_id UUID REFERENCES construction_sites(id),  -- 현장 ID
    action_type VARCHAR(50) NOT NULL,                -- 작업 유형 (생성/수정/삭제)
    previous_data JSONB,                             -- 변경 전 데이터
    new_data JSONB,                                  -- 변경 후 데이터
    changed_by UUID REFERENCES users(id),            -- 변경 수행자 ID
    changed_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP  -- 변경 일시
);
```

## 현장 구조
1. 현장 유형
   - 건축 현장: 건물 신축
   - 토목 현장: 도로, 교량
   - 플랜트 현장: 공장, 설비
   - 리모델링 현장: 건물 개보수

2. 현장 조직
   - 현장소장: 현장 총괄
   - 기술팀: 기술 관리
   - 안전팀: 안전 관리
   - 행정팀: 행정 업무

3. 현장 시설
   - 사무실: 현장 사무실
   - 창고: 자재 창고
   - 작업장: 작업 공간
   - 휴게실: 작업자 휴게 공간

## 운영 정책
1. 현장 관리
   - 현장 운영 규정
   - 안전 관리 규정
   - 품질 관리 규정

2. 인력 관리
   - 인력 배치 기준
   - 작업 시간 관리
   - 안전 교육

3. 자재 관리
   - 자재 입출고 절차
   - 재고 관리 기준
   - 품질 검수 기준

4. 일정 관리
   - 공정 계획 수립
   - 진행 상황 관리
   - 지연 대응 방안 