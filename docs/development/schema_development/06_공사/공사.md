# 공사 관리 시스템

## 시스템 개요
이 문서는 건설 공사의 관리 구조와 기능을 정의합니다.
공사 정보 관리, 공정 관리, 자재 관리, 안전 관리 등을 관리합니다.

## 주요 기능

### 1. 공사 정보 관리
공사의 기본 정보를 관리합니다.
- 공사 등록: 새로운 공사 등록
- 정보 수정: 공사 정보 변경
- 정보 조회: 공사 정보 조회
- 이력 관리: 정보 변경 이력 관리

### 2. 공정 관리
공사의 공정을 관리합니다.
- 공정 등록: 공정 정보 등록
- 공정 수정: 공정 정보 변경
- 공정 조회: 공정 목록 조회
- 진행 관리: 공정 진행 관리

### 3. 자재 관리
공사 자재를 관리합니다.
- 자재 등록: 자재 정보 등록
- 자재 수정: 자재 정보 변경
- 자재 조회: 자재 목록 조회
- 재고 관리: 자재 재고 관리

### 4. 안전 관리
공사의 안전을 관리합니다.
- 안전 등록: 안전 정보 등록
- 안전 수정: 안전 정보 변경
- 안전 조회: 안전 목록 조회
- 안전 분석: 안전 상황 분석

## DB 연계
```sql
-- 공사 테이블: 공사의 기본 정보를 저장합니다.
-- 예: 공사명, 공사금액, 공사기간, 발주자 등의 정보를 관리합니다.
CREATE TABLE construction_projects (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 공사의 고유 식별자
    name VARCHAR(100) NOT NULL,                      -- 공사명
    code VARCHAR(50) UNIQUE NOT NULL,                -- 공사 코드
    amount DECIMAL(15,2) NOT NULL,                   -- 공사 금액
    start_date DATE NOT NULL,                        -- 착공일
    end_date DATE NOT NULL,                          -- 준공일
    client_id UUID REFERENCES vendors(id),           -- 발주자 ID
    manager_id UUID REFERENCES users(id),            -- 공사 책임자 ID
    status VARCHAR(50) NOT NULL,                     -- 상태
    description TEXT,                                -- 설명
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 공사 상세 정보 테이블: 공사의 추가 정보를 저장합니다.
-- 예: 공사 유형, 공사 규모, 주요 공정 등을 관리합니다.
CREATE TABLE project_details (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 상세 정보의 고유 식별자
    project_id UUID REFERENCES construction_projects(id), -- 공사 ID
    project_type VARCHAR(100),                       -- 공사 유형
    total_area DECIMAL(10,2),                        -- 연면적
    building_count INTEGER,                          -- 동 수
    floor_count INTEGER,                             -- 층 수
    main_process TEXT,                               -- 주요 공정
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 공정 테이블: 공사의 공정 정보를 저장합니다.
-- 예: 공정명, 시작일, 종료일, 담당자 등을 관리합니다.
CREATE TABLE construction_processes (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 공정의 고유 식별자
    project_id UUID REFERENCES construction_projects(id), -- 공사 ID
    name VARCHAR(100) NOT NULL,                      -- 공정명
    start_date DATE NOT NULL,                        -- 시작일
    end_date DATE NOT NULL,                          -- 종료일
    manager_id UUID REFERENCES users(id),            -- 담당자 ID
    status VARCHAR(50),                              -- 상태
    progress_rate INTEGER DEFAULT 0,                 -- 진행률
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 자재 테이블: 공사 자재 정보를 저장합니다.
-- 예: 자재명, 수량, 단위, 공급업체 등을 관리합니다.
CREATE TABLE construction_materials (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 자재의 고유 식별자
    project_id UUID REFERENCES construction_projects(id), -- 공사 ID
    name VARCHAR(100) NOT NULL,                      -- 자재명
    quantity DECIMAL(10,2) NOT NULL,                 -- 수량
    unit VARCHAR(20) NOT NULL,                       -- 단위
    supplier_id UUID REFERENCES vendors(id),         -- 공급업체 ID
    status VARCHAR(50),                              -- 상태
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 안전 테이블: 공사 안전 정보를 저장합니다.
-- 예: 안전 점검, 사고 발생, 조치 사항 등을 관리합니다.
CREATE TABLE safety_management (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 안전의 고유 식별자
    project_id UUID REFERENCES construction_projects(id), -- 공사 ID
    check_type VARCHAR(50) NOT NULL,                 -- 점검 유형
    check_date DATE NOT NULL,                        -- 점검일
    checker_id UUID REFERENCES users(id),            -- 점검자 ID
    status VARCHAR(50),                              -- 상태
    findings TEXT,                                   -- 발견 사항
    actions TEXT,                                    -- 조치 사항
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 공사 이력 테이블: 공사 정보 변경 사항을 추적합니다.
-- 예: 공사명 변경, 금액 변경, 상태 변경 등의 이력을 관리합니다.
CREATE TABLE project_history (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 이력의 고유 식별자
    project_id UUID REFERENCES construction_projects(id), -- 공사 ID
    action_type VARCHAR(50) NOT NULL,                -- 작업 유형 (생성/수정/삭제)
    previous_data JSONB,                             -- 변경 전 데이터
    new_data JSONB,                                  -- 변경 후 데이터
    changed_by UUID REFERENCES users(id),            -- 변경 수행자 ID
    changed_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP  -- 변경 일시
);
```

## 공사 구조
1. 공사 유형
   - 건축 공사: 건물 신축
   - 토목 공사: 도로, 교량
   - 플랜트 공사: 공장, 설비
   - 리모델링 공사: 건물 개보수

2. 공사 단계
   - 착공 전: 준비 단계
   - 공사 중: 시공 단계
   - 준공 전: 마감 단계
   - 준공 후: 유지보수

3. 공사 조직
   - 공사 책임자: 공사 총괄
   - 기술팀: 기술 관리
   - 안전팀: 안전 관리
   - 행정팀: 행정 업무

## 운영 정책
1. 공사 관리
   - 공사 등록 절차
   - 공사 변경 절차
   - 공사 종료 절차

2. 공정 관리
   - 공정 계획 수립
   - 진행 상황 관리
   - 지연 대응 방안

3. 자재 관리
   - 자재 입출고 절차
   - 재고 관리 기준
   - 품질 검수 기준

4. 안전 관리
   - 안전 점검 주기
   - 사고 대응 절차
   - 안전 교육 계획

[[공사명]]
[[계약번호]]
[[입찰여부]]
[[계약방식]]
[[계약금액]]
[[계약일]]
[[착공일]]
[[준공예정일]]
[[실제 준공일]]
[[청구일]]
[[세금계산서발행 여부 및 일자]]
[[공사의 상태]]
[[발주처]]
