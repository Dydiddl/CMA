# 거래처 관리

## 거래처 유형
1. 자재 공급업체
   - 건설 자재
   - 시설 자재
   - 소모품

2. 용역 업체
   - 설계 용역
   - 시공 용역
   - 감리 용역
   - 기타 용역

3. 장비 임대업체
   - 중장비
   - 운반장비
   - 특수장비

4. 기타 거래처
   - 운송업체
   - 보험사
   - 금융기관

## DB 연계
```sql
-- 거래처 기본 정보 테이블: 거래처의 기본적인 정보를 저장하는 테이블입니다.
-- 예: 회사명, 사업자번호, 대표자명, 연락처 등 기본 정보를 관리합니다.
CREATE TABLE vendors (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 거래처의 고유 식별자
    company_name VARCHAR(200) NOT NULL,              -- 회사명
    business_number VARCHAR(20) UNIQUE NOT NULL,     -- 사업자등록번호
    representative_name VARCHAR(100),                -- 대표자명
    company_type VARCHAR(50) NOT NULL,               -- 거래처 유형 (자재/용역/임대 등)
    address TEXT,                                    -- 주소
    phone VARCHAR(20),                               -- 대표 전화번호
    email VARCHAR(255),                              -- 대표 이메일
    website VARCHAR(255),                            -- 웹사이트
    status VARCHAR(20) DEFAULT 'active',             -- 상태 (활성/비활성/거래중지 등)
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 등록 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 거래처 상세 정보 테이블: 거래처의 추가적인 상세 정보를 저장하는 테이블입니다.
-- 예: 업종, 매출액, 직원수, 주요 거래품목 등 상세 정보를 관리합니다.
CREATE TABLE vendor_details (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 상세 정보의 고유 식별자
    vendor_id UUID REFERENCES vendors(id),           -- 거래처 ID
    industry VARCHAR(100),                           -- 업종
    annual_revenue DECIMAL(15,2),                    -- 연간 매출액
    employee_count INTEGER,                          -- 직원 수
    main_products TEXT,                              -- 주요 거래품목
    business_areas TEXT,                             -- 사업 영역
    certifications TEXT,                             -- 보유 인증
    notes TEXT,                                      -- 기타 참고사항
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 등록 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 거래처 계좌 정보 테이블: 거래처의 계좌 정보를 저장하는 테이블입니다.
-- 예: 입금 계좌, 지급 계좌, 세금계산서 발행 정보 등을 관리합니다.
CREATE TABLE vendor_accounts (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 계좌 정보의 고유 식별자
    vendor_id UUID REFERENCES vendors(id),           -- 거래처 ID
    account_type VARCHAR(50) NOT NULL,               -- 계좌 유형 (입금/지급/세금계산서 등)
    bank_name VARCHAR(100),                          -- 은행명
    account_number VARCHAR(50),                      -- 계좌번호
    account_holder VARCHAR(100),                     -- 예금주
    tax_email VARCHAR(255),                          -- 세금계산서 이메일
    is_default BOOLEAN DEFAULT FALSE,                -- 기본 계좌 여부
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 등록 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 거래처 평가 정보 테이블: 거래처의 평가 관련 정보를 저장하는 테이블입니다.
-- 예: 현재 등급, 누적 평가 점수, 최근 평가 일자 등을 관리합니다.
CREATE TABLE vendor_evaluations (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 평가 정보의 고유 식별자
    vendor_id UUID REFERENCES vendors(id),           -- 거래처 ID
    current_grade VARCHAR(2),                        -- 현재 등급 (S/A/B/C/D)
    average_score DECIMAL(5,2),                      -- 평균 평가 점수
    last_evaluation_date DATE,                       -- 최근 평가 일자
    evaluation_count INTEGER DEFAULT 0,              -- 평가 횟수
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 등록 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 거래처 이력 테이블
CREATE TABLE vendor_history (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    vendor_id UUID REFERENCES vendors(id),
    change_type VARCHAR(50) NOT NULL,
    previous_data JSONB,
    new_data JSONB,
    changed_by UUID REFERENCES users(id),
    changed_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

## 거래처 관리 기능
1. 거래처 등록
   - 기본 정보 입력
   - 상세 정보 입력
   - 계좌 정보 입력
   - 담당자 정보 입력

2. 거래처 수정
   - 정보 업데이트
   - 상태 변경
   - 평가 관리
   - 이력 관리

3. 거래처 조회
   - 기본 정보 조회
   - 거래 이력 조회
   - 평가 이력 조회
   - 계약 정보 조회

## 거래처 평가 체계
1. 평가 항목
   - 품질 평가
   - 납기 평가
   - 가격 평가
   - 서비스 평가

2. 평가 주기
   - 정기 평가
   - 수시 평가
   - 계약 종료 평가

3. 평가 결과 활용
   - 거래처 등급 관리
   - 거래 제한 관리
   - 우수 거래처 선정
