# 사용자 관리 시스템

## 시스템 개요
이 문서는 사용자 계정 관리 시스템의 구조와 기능을 정의합니다.
시스템 사용자의 등록, 수정, 삭제 및 권한 관리를 담당합니다.

## 주요 기능

### 1. 사용자 계정 관리
사용자의 기본 정보와 계정 상태를 관리합니다.
- 계정 등록: 새로운 사용자 등록
- 정보 수정: 사용자 정보 변경
- 계정 삭제: 사용자 계정 삭제
- 상태 관리: 계정 활성화/비활성화

### 2. 인증 관리
사용자의 로그인과 보안을 관리합니다.
- 로그인/로그아웃 처리
- 비밀번호 관리
- 보안 설정
- 접근 제한

### 3. 프로필 관리
사용자의 개인 정보와 설정을 관리합니다.
- 개인정보 관리
- 알림 설정
- 환경 설정
- 언어 설정

## DB 연계
```sql
-- 사용자 기본 정보 테이블: 시스템 사용자의 기본 정보를 저장합니다.
-- 예: 이름, 이메일, 전화번호, 부서 등 기본 정보를 관리합니다.
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 사용자의 고유 식별자
    username VARCHAR(50) UNIQUE NOT NULL,            -- 로그인 아이디
    password_hash VARCHAR(255) NOT NULL,             -- 암호화된 비밀번호
    email VARCHAR(255) UNIQUE NOT NULL,              -- 이메일 주소
    full_name VARCHAR(100) NOT NULL,                 -- 사용자 이름
    phone VARCHAR(20),                               -- 연락처
    department_id UUID REFERENCES departments(id),   -- 소속 부서 ID
    position VARCHAR(50),                            -- 직위
    status VARCHAR(20) DEFAULT 'active',             -- 계정 상태 (활성/비활성/잠금)
    last_login TIMESTAMP WITH TIME ZONE,             -- 마지막 로그인 일시
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 계정 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 정보 수정 일시
);

-- 사용자 프로필 테이블: 사용자의 추가 정보와 설정을 저장합니다.
-- 예: 프로필 사진, 개인 설정, 알림 설정 등을 관리합니다.
CREATE TABLE user_profiles (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 프로필의 고유 식별자
    user_id UUID REFERENCES users(id),               -- 사용자 ID
    profile_image VARCHAR(255),                      -- 프로필 이미지 경로
    language VARCHAR(10) DEFAULT 'ko',               -- 선호 언어
    timezone VARCHAR(50) DEFAULT 'Asia/Seoul',       -- 시간대 설정
    notification_settings JSONB,                     -- 알림 설정
    theme_settings JSONB,                            -- 테마 설정
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,  -- 생성 일시
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP   -- 수정 일시
);

-- 사용자 이력 테이블: 사용자 정보의 변경 사항을 추적합니다.
-- 예: 정보 수정, 상태 변경, 로그인 시도 등의 이력을 관리합니다.
CREATE TABLE user_history (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),  -- 이력의 고유 식별자
    user_id UUID REFERENCES users(id),               -- 사용자 ID
    action_type VARCHAR(50) NOT NULL,                -- 작업 유형 (수정/삭제/로그인 등)
    previous_data JSONB,                             -- 변경 전 데이터
    new_data JSONB,                                  -- 변경 후 데이터
    ip_address VARCHAR(45),                          -- IP 주소
    user_agent TEXT,                                 -- 사용자 브라우저 정보
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP  -- 이력 생성 일시
);
```

## 보안 정책
1. 비밀번호 정책
   - 최소 8자 이상
   - 영문, 숫자, 특수문자 조합
   - 90일마다 변경 필요
   - 이전 3개 비밀번호 재사용 불가

2. 접근 제한
   - 5회 로그인 실패 시 계정 잠금
   - 30분 미사용 시 자동 로그아웃
   - IP 기반 접근 제한 가능

3. 데이터 보호
   - 개인정보 암호화 저장
   - 중요 작업 로그 기록
   - 정기적인 보안 감사

## 연계 시스템
1. 권한 관리 시스템
   - 사용자별 권한 설정
   - 역할 기반 접근 제어
   - 메뉴 접근 권한

2. 부서 관리 시스템
   - 소속 부서 정보
   - 조직도 연동
   - 인사 정보 연동

3. 알림 시스템
   - 이메일 알림
   - 시스템 알림
   - SMS 알림